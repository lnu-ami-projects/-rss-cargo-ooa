# Security Model for RSS Cargo

## 1. Threat Model

### Основні загрози в рамках флоу проекту

#### Флоу 1: **Реєстрація користувача**

- **Загроза**: SQL-ін’єкція в процесі реєстрації.
- **Загроза**: Перехоплення пароля через незахищений трафік.

#### Флоу 2: **Авторизація та аутентифікація**

- **Загроза**: Brute-force атака для злому облікових записів.
- **Загроза**: Використання скомпрометованих облікових даних (Credential Stuffing).

#### Флоу 3: **Доступ до RSS-стрічок**

- **Загроза**: Несанкціонований доступ до приватних контейнерів.
- **Загроза**: Ін’єкція шкідливого контенту в RSS-стрічки.

#### Флоу 4: **Управління контейнерами**

- **Загроза**: Підміна сесії через XSS-атаки.
- **Загроза**: CSRF-атака при додаванні чи видаленні контейнерів.

#### Флоу 5: **Обробка API-запитів**

- **Загроза**: DDoS-атака на API-сервіси.
- **Загроза**: Витік даних через недостатньо захищені API-ендоінти.

#### Флоу 6: **Обробка даних у базі**

- **Загроза**: Неконтрольований доступ до бази даних.
- **Загроза**: Відсутність шифрування чутливих даних (наприклад, паролів).

#### Флоу 7: **Моніторинг і логування**

- **Загроза**: Некоректна анонімізація логів, що містять персональні дані.
- **Загроза**: Несанкціонований доступ до моніторингових систем.

---

## 2. Mitigation Plan

### Таблиця 10 критичних загроз та планів дій

| Загроза                                          | Рівень критичності | Mitigation Plan                                                                                  |
| ------------------------------------------------ | ------------------ | ------------------------------------------------------------------------------------------------ |
| SQL-ін’єкція                                     | Висока             | Впровадження ORM (наприклад, Entity Framework), використання параметризованих запитів.           |
| Перехоплення пароля                              | Висока             | Використання HTTPS для всіх з'єднань, впровадження TLS 1.2/1.3.                                  |
| Brute-force атака                                | Висока             | Впровадження обмеження спроб входу, додавання CAPTCHA.                                           |
| Credential Stuffing                              | Висока             | Підтримка 2FA (двофакторна автентифікація), перевірка паролів через бази скомпрометованих даних. |
| Несанкціонований доступ до контейнерів           | Висока             | Реалізація ACL (Access Control List), валідація прав доступу до контейнерів.                     |
| Ін’єкція шкідливого контенту в RSS               | Висока             | Санітизація вхідного контенту (HTML/JavaScript) перед збереженням у базу.                        |
| XSS-атака                                        | Висока             | Використання CSP (Content Security Policy), екранування всіх вхідних даних.                      |
| CSRF-атака                                       | Висока             | Впровадження CSRF-токенів у всі запити, валідація токенів на сервері.                            |
| DDoS-атака                                       | Висока             | Використання WAF (Web Application Firewall), лімітування запитів на рівні API Gateway.           |
| Витік даних через недостатньо захищені API       | Висока             | Впровадження API Gateway із вимогою авторизації (OAuth 2.0, JWT).                                |
| Неконтрольований доступ до бази даних            | Висока             | Використання VPN для адміністративного доступу, обмеження IP-адрес через брандмауер.             |
| Відсутність шифрування паролів                   | Висока             | Зберігання паролів у хешованому вигляді (bcrypt із сильними параметрами).                        |
| Некоректна анонімізація логів                    | Середня            | Впровадження політик логування з виключенням персональних даних.                                 |
| Несанкціонований доступ до моніторингових систем | Середня            | Використання MFA (Multi-Factor Authentication), обмеження доступу до моніторингових ресурсів.    |

---

## 3. Висновок

Застосування Threat Modeling допомагає виявити критичні загрози на ранніх етапах розробки. Використання Mitigation Plan гарантує зменшення вразливостей та забезпечує стабільність і безпеку системи RSS Cargo.
